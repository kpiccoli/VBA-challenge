Sub RunEveryWS()

Dim xSh As Worksheet
Application.ScreenUpdating = False
For Each xSh In Worksheets
    xSh.Select
    Call StockMarketAnalyst
    
    Next
    Application.ScreenUpdating = True


End Sub

Sub StockMarketAnalyst()

'Define variables
Dim TickerName As String
Dim YearlyOpen As Double
Dim YearlyClose As Double
Dim YearlyChange As Double
Dim PercentChange As Double
Dim StockTotalVolume As Double
Dim summarytablerow As Integer
summarytablerow = 2
Dim i As Double
Dim j As Double

j = 2

    'Column headers Part I
        Cells(1, 9).Value = "Ticker Name"
        Cells(1, 10).Value = "Yearly Change"
        Cells(1, 11).Value = "Percent Change"
        Cells(1, 12).Value = "Total Stock Volume"

    'Count the number of rows
        lastrow = Cells(Rows.Count, 1).End(xlUp).Row

'Loop through
    For i = 2 To lastrow
             
        If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then
            
            'Define values
            TickerName = Cells(i, 1).Value
            YearlyOpen = Cells(i, 3).Value
            YearlyClose = Cells(i, 6).Value
            
            StockTotalVolume = Cells(i, 7).Value
            
            'Add to summary table
            YearlyChange = YearlyClose - YearlyOpen
            PercentChange = (YearlyClose - YearlyOpen) / YearlyClose
            StockTotalVolume = StockTotalVolume + Cells(i, 7).Value

            'Print to summary table
            range("I" & summarytablerow).Value = TickerName
            range("J" & summarytablerow).Value = YearlyChange
            range("K" & summarytablerow).Value = PercentChange
            range("L" & summarytablerow).Value = StockTotalVolume
            summarytablerow = summarytablerow + 1
            Columns("K").NumberFormat = "0.00%"
            
            
         Else
         Ticker = Ticker + Cells(i, 1).Value
         
         End If
         
          'Highlight positive Change in green and negative Change in red
            If Cells(i, 11).Value >= 0 Then
            
                Cells(i, 11).Interior.ColorIndex = 4
            Else
                Cells(i, 11).Interior.ColorIndex = 3
                
    
        End If
     
     Next i
     
     
     
   'Define variables
    Dim GreatestIncrease As Double
    Dim GreatestDecreases As Double
    Dim greatesttotalvolume As Double
       
    'Column headers Part II
    Cells(2, 14).Value = "GreatestIncrease"
    Cells(3, 14).Value = "GreatestDecrease"
    Cells(4, 14).Value = "GreatestTotalVolume"
        
    GreatestIncrease = Application.WorksheetFunction.Max(range("K:K"))
    GreatestDecrease = Application.WorksheetFunction.Min(range("K:K"))
    greatesttotalvolume = Application.WorksheetFunction.Max(range("L:L"))
    
    

    Cells(2, 15).Value = Cells(j, 9).Value
    Cells(3, 15).Value = Cells(j, 9).Value
    Cells(4, 15).Value = Cells(j, 9).Value
    
    'Print to summary table
    Cells(2, 16).Value = GreatestIncrease
    Cells(3, 16).Value = GreatestDecrease
    Cells(4, 16).Value = greatesttotalvolume
    
    Cells(1, 15).Value = "TickerName"
    Cells(1, 16).Value = "Value"
    

End Sub






